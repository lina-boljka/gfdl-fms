
module tstd_mod

!-----------------------------------------------------------------------

implicit none
private

!-----------------------------------------------------------------------
!---------- interfaces ------------

   public :: us_tstd

!-----------------------------------------------------------------------

   character(len=128) :: version='$Id: tstd.f90,v 1.0 2012/10/10 14:38:08 fms Exp $'
   character(len=128) :: tagname='$Name: latest $'

!-----------------------------------------------------------------------

contains

!#######################################################################

 subroutine us_tstd ( pres, t_stand )

!-----------------------------------------------------------------------
     real, intent(in),  dimension(:) :: pres
     real, intent(out), dimension(:) :: t_stand
!-----------------------------------------------------------------------
     integer                         :: i
     double precision, dimension(401)            :: ttab, ptab

!-----------------------------------------------------------------------
! Set the table values

  ptab = (/ 1013.2500,  898.76285,  897.49844,  896.22082,  894.92987,  893.62547,  892.30751,  890.97585,  889.63037,  888.27096,  &
            886.89748,  885.50981,  884.10783,  882.69141,  881.26042,  879.81474,  878.35424,  876.87879,  875.38826,  873.88252,  &
            872.36144,  870.82489,  869.27274,  867.70487,  866.12113,  864.52139,  862.90553,  861.27341,  859.62489,  857.95984,  &
            856.27813,  854.57963,  852.86419,  851.13168,  849.38198,  847.61493,  845.83041,  844.02829,  842.20842,  840.37066,  &
            838.51489,  836.64096,  834.74874,  832.83810,  830.90889,  828.96098,  826.99423,  825.00851,  823.00368,  820.97961,  &
            818.93615,  816.87318,  814.79056,  812.68815,  810.56582,  808.42344,  806.26087,  804.07798,  801.87463,  799.65070,  &
            797.40605,  795.14056,  792.85409,  790.54651,  788.21770,  785.86752,  783.49586,  781.10259,  778.68758,  776.25071,  &
            773.79185,  771.31089,  768.80771,  766.28219,  763.73422,  761.16367,  758.57043,  755.95440,  753.31545,  750.65350,  &
            747.96842,  745.26011,  742.52847,  739.77340,  736.99481,  734.19258,  731.36664,  728.51689,  725.64325,  722.74561,  &
            719.82391,  716.87806,  713.90799,  710.91361,  707.89486,  704.85167,  701.78397,  698.69170,  695.57480,  692.43322,  &
            689.26691,  686.07581,  682.85990,  679.61911,  676.35343,  673.06282,  669.74725,  666.40669,  663.04115,  659.65059,  &
            656.23501,  652.79441,  649.32880,  645.83817,  642.32254,  638.78193,  635.21636,  631.62587,  628.01048,  624.37024,  &
            620.70520,  617.01541,  613.30094,  609.56184,  605.79819,  602.01008,  598.19759,  594.36081,  590.49986,  586.61483,  &
            582.70586,  578.77305,  574.81655,  570.83650,  566.83305,  562.80635,  558.75658,  554.68391,  550.58852,  546.47060,  &
            542.33037,  538.16803,  533.98381,  529.77793,  525.55064,  521.30219,  517.03284,  512.74286,  508.43254,  504.10217,  &
            499.75205,  495.38249,  490.99383,  486.58641,  482.16056,  477.71665,  473.25505,  468.77615,  464.28034,  459.76802,  &
            455.23962,  450.69557,  446.13632,  441.56231,  436.97403,  432.37195,  427.75657,  423.12839,  418.48794,  413.83576,  &
            409.17238,  404.49837,  399.81431,  395.12078,  390.41839,  385.70774,  380.98947,  376.26422,  371.53265,  366.79541,  &
            362.05320,  357.30671,  352.55665,  347.80375,  343.04874,  338.29236,  333.53540,  328.77861,  324.02279,  319.26874,  &
            314.51728,  309.76924,  305.02546,  300.28679,  295.55409,  290.82825,  286.11016,  281.40070,  276.70081,  272.01140,  &
            267.33340,  262.66777,  258.01544,  253.37740,  248.75461,  244.14806,  239.55873,  234.98763,  230.43576,  225.90358,  &
            221.40336,  216.94228,  212.52104,  208.14034,  203.80082,  199.50317,  195.24800,  191.03596,  186.86764,  182.74365,  &
            178.66457,  174.63094,  170.64333,  166.70224,  162.80818,  158.96165,  155.16310,  151.41298,  147.71172,  144.05973,  &
            140.45738,  136.90503,  133.40303,  129.95169,  126.55131,  123.20215,  119.90446,  116.65847,  113.46437,  110.32233,  &
            107.23252,  104.19504,  101.21001,  98.277500,  95.397557,  92.570208,  89.795454,  87.073269,  84.403602,  81.786379,  &
            79.221497,  76.708833,  74.248233,  71.839524,  69.482504,  67.176949,  64.922609,  62.719213,  60.566463,  58.464039,  &
            56.411599,  54.408081,  52.455889,  50.554440,  48.703148,  46.901410,  45.148604,  43.444096,  41.787235,  40.177355,  &
            38.613778,  37.095813,  35.622756,  34.193891,  32.808495,  31.465830,  30.165154,  28.905713,  27.686748,  26.507493,  &
            25.367174,  24.265015,  23.200234,  22.172045,  21.179662,  20.222295,  19.299151,  18.409442,  17.552374,  16.727160,  &
            15.933010,  15.169140,  14.434767,  13.729114,  13.051405,  12.400874,  11.776757,  11.178298,  10.604748,  10.055366,  &
            9.5294188,  9.0261810,  8.5450457,  8.0861033,  7.6488928,  7.2325577,  6.8362658,  6.4592093,  6.1006038,  5.7596890,  &
            5.4357278,  5.1280061,  4.8358326,  4.5585382,  4.2954762,  4.0460214,  3.8095697,  3.5855382,  3.3733644,  3.1725060,  &
            2.9824401,  2.8026633,  2.6326910,  2.4720569,  2.3203127,  2.1770276,  2.0417876,  1.9141957,  1.7938708,  1.6804476,  &
            1.5735758,  1.4729203,  1.3781599,  1.2889877,  1.2051100,  1.1262464,  1.0519596,  0.9818625,  0.9157142,  0.8533417,  &
            0.79457675,  0.73925568,  0.68721945,  0.63828251, 0.59205005,  0.54843489,  0.50733987,  0.46866852,  0.43232519,  &
            0.39821525,  0.36624515,  0.33632259,  0.30835660,  0.28225773,  0.25793807,  0.23531145,  0.21429346,  0.19480162, &
            0.17675541,  0.16007639,  0.14468826,  0.13051694,  0.11749062,  0.10553982,  0.094597446,  0.084598825,  0.075481728,  &
            0.067186400,  0.059655581,  0.052834506,  0.046670911, 0.041115024,  0.036123351,  0.031658471,  0.027675041,  &
            0.024129760,  0.020982291,  0.018195144,  0.015733562,  0.013565396,  0.011660983,  0.0099930271,  0.0085364731,  &
            0.0072683866, 0.0061678316,  0.0052157510,  0.0043948490,  0.0036876523,  0.0030872324,  0.0025804170,  0.0021533642,  &
            0.0017909697,  0.0014872042,  0.0012352112,  0.0010226357,  0.00084407013, 0.00069714153,  0.00057429589,  &
            0.00047287778,  0.00038867394,  0.00031960224 /)

  ttab = (/ 288.15000,  281.66125,  281.58592,  281.50972,  281.43264,  281.35466,  281.27577,  281.19597,  281.11525,  281.03358,  &
            280.95097,  280.86740,  280.78286,  280.69734,  280.61082,  280.52330,  280.43477,  280.34520,  280.25460,  280.16294,  &
            280.07022,  279.97643,  279.88155,  279.78556,  279.68846,  279.59023,  279.49087,  279.39035,  279.28866,  279.18579,  &
            279.08173,  278.97646,  278.86996,  278.76224,  278.65326,  278.54301,  278.43149,  278.31867,  278.20454,  278.08909,  &
            277.97229,  277.85414,  277.73462,  277.61372,  277.49140,  277.36767,  277.24250,  277.11588,  276.98779,  276.85821,  &
            276.72713,  276.59453,  276.46038,  276.32468,  276.18741,  276.04854,  275.90806,  275.76594,  275.62218,  275.47675,  &
            275.32963,  275.18080,  275.03025,  274.87795,  274.72388,  274.56802,  274.41035,  274.25085,  274.08950,  273.92628,  &
            273.76116,  273.59412,  273.42515,  273.25421,  273.08129,  272.90637,  272.72941,  272.55040,  272.36931,  272.18611,  &
            272.00079,  271.81332,  271.62368,  271.43183,  271.23775,  271.04143,  270.84282,  270.64191,  270.43866,  270.23306,  &
            270.02506,  269.81466,  269.60181,  269.38649,  269.16867,  268.94832,  268.72542,  268.49993,  268.27182,  268.04106,  &
            267.80762,  267.57147,  267.33258,  267.09092,  266.84645,  266.59915,  266.34897,  266.09589,  265.83987,  265.58088,  &
            265.31889,  265.05385,  264.78573,  264.51451,  264.24013,  263.96257,  263.68178,  263.39774,  263.11040,  262.81973,  &
            262.52568,  262.22821,  261.92730,  261.62289,  261.31494,  261.00342,  260.68829,  260.36950,  260.04700,  259.72076,  &
            259.39074,  259.05688,  258.71915,  258.37750,  258.03188,  257.68225,  257.32856,  256.97077,  256.60882,  256.24267,  &
            255.87227,  255.49757,  255.11851,  254.73506,  254.34716,  253.95476,  253.55780,  253.15623,  252.75000,  252.33905,  &
            251.92334,  251.50279,  251.07737,  250.64701,  250.21165,  249.77123,  249.32571,  248.87501,  248.41908,  247.95786,  &
            247.49128,  247.01929,  246.54182,  246.05880,  245.57018,  245.07589,  244.57586,  244.07002,  243.55831,  243.04066,  &
            242.51700,  241.98727,  241.45138,  240.90927,  240.36087,  239.80611,  239.24490,  238.67718,  238.10286,  237.52188,  &
            236.93416,  236.33961,  235.73817,  235.12974,  234.51424,  233.89160,  233.26174,  232.62456,  231.97998,  231.32793,  &
            230.66830,  230.00101,  229.32598,  228.64312,  227.95232,  227.25351,  226.54658,  225.83145,  225.10802,  224.37619,  &
            223.63586,  222.88694,  222.12932,  221.36291,  220.58760,  219.80330,  219.00988,  218.20726,  217.39532,  216.65000,  &
            216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  &
            216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  &
            216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  &
            216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  &
            216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  216.65000,  &
            216.65000,  216.68943,  216.92089,  217.15504,  217.39190,  217.63152,  217.87392,  218.11913,  218.36719,  218.61813,  &
            218.87198,  219.12878,  219.38856,  219.65135,  219.91720,  220.18613,  220.45818,  220.73339,  221.01180,  221.29344,  &
            221.57835,  221.86656,  222.15812,  222.45307,  222.75144,  223.05327,  223.35861,  223.66749,  223.97996,  224.29606,  &
            224.61582,  224.93930,  225.26653,  225.59756,  225.93243,  226.27119,  226.61389,  226.96056,  227.31125,  227.66602,  &
            228.02490,  228.38796,  228.94337,  229.97922,  231.02709,  232.08713,  233.15947,  234.24427,  235.34165,  236.45178,  &
            237.57479,  238.71084,  239.86007,  241.02265,  242.19873,  243.38845,  244.59199,  245.80950,  247.04114,  248.28708,  &
            249.54749,  250.82252,  252.11236,  253.41717,  254.73712,  256.07241,  257.42319,  258.78965,  260.17197,  261.57034,  &
            262.98495,  264.41597,  265.86361,  267.32806,  268.80950,  270.30814,  270.65000,  270.65000,  270.65000,  270.65000,  &
            270.65000,  270.65000,  270.65000,  269.60010,  267.94871,  266.27815,  264.58820,  262.87864,  261.14922,  259.39973,  &
            257.62993,  255.83959,  254.02846,  252.19631,  250.34289,  248.46795,  246.57125,  244.65253,  242.71153,  240.74801,  &
            238.76168,  236.75231,  234.71960,  232.66330,  230.58313,  228.47880,  226.35006,  224.19659,  222.01813,  219.81439,  &
            217.58505,  215.32984,  213.51235,  211.87296,  210.21454,  208.53686,  206.83971,  205.12286,  203.38608,  201.62914,  &
            199.85180,  198.05383,  196.23499,  194.39503,  192.53372,  190.65079,  188.74601,  186.86730,  186.86730,  186.86730,  &
            186.86730,  186.86730,  186.87041,  187.01462,  187.38071,  187.97969,  188.82528,  189.93444,  191.32819,  193.03278,  &
            195.08135 /)

     do i = 1, size(pres)
       call interpol(pres(i),t_stand(i),ptab,ttab,401)
     enddo

 end subroutine us_tstd

!#######################################################################

 subroutine interpol ( x, y, xtab, ytab, ntab )

!-----------------------------------------------------------------------
      integer, intent(in) :: ntab
      real, intent(in)    :: x, xtab(:), ytab(:)
      real, intent(out)   :: y
!-----------------------------------------------------------------------
      integer :: i1, ilast
      real    :: wx
!-----------------------------------------------------------------------
      save ilast
      data ilast/1/
!-----------------------------------------------------------------------

      if (x .LE. xtab(ilast+1)) then
        do 30 i1 = ilast, 1, -1
          if (x .GE. xtab(i1)) goto 60
  30        continue
        stop
      else
        do 40 i1 = ilast+1, ntab-1
          if (x .LE. xtab(i1+1)) goto 60
  40        continue
        stop
      endif

  60  wx = (x-xtab(i1))/(xtab(i1+1)-xtab(i1))
      y  =(1-wx)*ytab(i1)+wx*ytab(i1+1)
      ilast = i1

 end subroutine interpol

!#######################################################################

end module tstd_mod
